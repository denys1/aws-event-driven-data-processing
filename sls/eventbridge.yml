Resources:
  EventRule:
    Type: AWS::Events::Rule
    Properties:
      Name: ${self:service}-${self:provider.stage}-s3-rule
      Description: "Rule to capture S3 events"
      EventPattern:
        source:
          - aws.s3
        detail-type:
          - "AWS API Call via CloudTrail"
        detail:
          eventSource:
            - s3.amazonaws.com
          eventName:
            - PutObject
          requestParameters:
            bucketName:
              - ${self:custom.inputBucket}
      State: ENABLED
      Targets:
        - Arn: 
            Fn::ImportValue: ${self:service}-${self:provider.stage}-TopicArn
          Id: "S3ToSNS"

  EventBridgeLogGroup:
    Type: AWS::Logs::LogGroup
    Properties:
      LogGroupName: /aws/events/${self:service}-${self:provider.stage}-eventbridge
      RetentionInDays: 14
